{"level":"info","message":"Connected to MongoDB","service":"branch-service","timestamp":"2025-05-12 21:55:31:5531"}
{"level":"info","message":"Creating headquarters branch...","service":"branch-service","timestamp":"2025-05-12 21:55:31:5531"}
{"level":"info","message":"Creating regional branches...","service":"branch-service","timestamp":"2025-05-12 21:55:31:5531"}
{"level":"info","message":"Creating branch offices...","service":"branch-service","timestamp":"2025-05-12 21:55:32:5532"}
{"level":"info","message":"Seed data completed successfully","service":"branch-service","timestamp":"2025-05-12 21:55:33:5533"}
{"level":"info","message":"Branch Management Service running on port 3003","service":"branch-service","timestamp":"2025-05-12 22:01:28:128"}
{"level":"info","message":"Redis client connected","service":"branch-service","timestamp":"2025-05-12 22:01:28:128"}
{"level":"info","message":"Connected to Redis","service":"branch-service","timestamp":"2025-05-12 22:01:28:128"}
{"level":"info","message":"Connected to MongoDB","service":"branch-service","timestamp":"2025-05-12 22:01:29:129"}
{"level":"info","message":"Branch Management Service running on port 3003","service":"branch-service","timestamp":"2025-05-12 22:02:07:27"}
{"level":"info","message":"Redis client connected","service":"branch-service","timestamp":"2025-05-12 22:02:07:27"}
{"level":"info","message":"Connected to Redis","service":"branch-service","timestamp":"2025-05-12 22:02:08:28"}
{"level":"info","message":"Connected to MongoDB","service":"branch-service","timestamp":"2025-05-12 22:02:08:28"}
{"ip":"::1","level":"info","message":"GET /api-docs/","method":"GET","requestId":"req-1747062144050-zqjbxw3ivep","service":"branch-service","timestamp":"2025-05-12 22:02:24:224","url":"/api-docs/"}
{"duration":24,"ip":"::1","level":"info","message":"GET / 200 - 24ms","method":"GET","requestId":"req-1747062144050-zqjbxw3ivep","service":"branch-service","status":200,"timestamp":"2025-05-12 22:02:24:224","url":"/"}
{"ip":"::1","level":"info","message":"GET /api-docs/swagger-ui.css","method":"GET","requestId":"req-1747062144131-q1yu2n78a9n","service":"branch-service","timestamp":"2025-05-12 22:02:24:224","url":"/api-docs/swagger-ui.css"}
{"ip":"::1","level":"info","message":"GET /api-docs/swagger-ui-bundle.js","method":"GET","requestId":"req-1747062144134-ppybvq8yiz","service":"branch-service","timestamp":"2025-05-12 22:02:24:224","url":"/api-docs/swagger-ui-bundle.js"}
{"ip":"::1","level":"info","message":"GET /api-docs/swagger-ui-standalone-preset.js","method":"GET","requestId":"req-1747062144138-cdgwmhipar","service":"branch-service","timestamp":"2025-05-12 22:02:24:224","url":"/api-docs/swagger-ui-standalone-preset.js"}
{"ip":"::1","level":"info","message":"GET /api-docs/swagger-ui-init.js","method":"GET","requestId":"req-1747062144140-ja42hhty8lf","service":"branch-service","timestamp":"2025-05-12 22:02:24:224","url":"/api-docs/swagger-ui-init.js"}
{"duration":5,"ip":"::1","level":"info","message":"GET /swagger-ui-init.js 200 - 5ms","method":"GET","requestId":"req-1747062144140-ja42hhty8lf","service":"branch-service","status":200,"timestamp":"2025-05-12 22:02:24:224","url":"/swagger-ui-init.js"}
{"duration":21,"ip":"::1","level":"info","message":"GET /swagger-ui.css 200 - 21ms","method":"GET","requestId":"req-1747062144131-q1yu2n78a9n","service":"branch-service","status":200,"timestamp":"2025-05-12 22:02:24:224","url":"/swagger-ui.css"}
{"duration":21,"ip":"::1","level":"info","message":"GET /swagger-ui-standalone-preset.js 200 - 21ms","method":"GET","requestId":"req-1747062144138-cdgwmhipar","service":"branch-service","status":200,"timestamp":"2025-05-12 22:02:24:224","url":"/swagger-ui-standalone-preset.js"}
{"duration":82,"ip":"::1","level":"info","message":"GET /swagger-ui-bundle.js 200 - 82ms","method":"GET","requestId":"req-1747062144134-ppybvq8yiz","service":"branch-service","status":200,"timestamp":"2025-05-12 22:02:24:224","url":"/swagger-ui-bundle.js"}
{"ip":"::1","level":"info","message":"GET /api-docs/favicon-32x32.png","method":"GET","requestId":"req-1747062144590-wyx572yfgt","service":"branch-service","timestamp":"2025-05-12 22:02:24:224","url":"/api-docs/favicon-32x32.png"}
{"duration":3,"ip":"::1","level":"info","message":"GET /favicon-32x32.png 200 - 3ms","method":"GET","requestId":"req-1747062144590-wyx572yfgt","service":"branch-service","status":200,"timestamp":"2025-05-12 22:02:24:224","url":"/favicon-32x32.png"}
{"ip":"::1","level":"info","message":"GET /api/v1/branches?page=1&limit=10&type=headquarters&status=active&sortBy=name&sortOrder=asc","method":"GET","requestId":"req-1747062165524-7n19ajpet04","service":"branch-service","timestamp":"2025-05-12 22:02:45:245","url":"/api/v1/branches?page=1&limit=10&type=headquarters&status=active&sortBy=name&sortOrder=asc"}
{"duration":2,"ip":"::1","level":"warn","message":"GET /?page=1&limit=10&type=headquarters&status=active&sortBy=name&sortOrder=asc 401 - 2ms","method":"GET","requestId":"req-1747062165524-7n19ajpet04","service":"branch-service","status":401,"timestamp":"2025-05-12 22:02:45:245","url":"/?page=1&limit=10&type=headquarters&status=active&sortBy=name&sortOrder=asc"}
{"ip":"::1","level":"info","message":"GET /api/v1/branches?page=1&limit=10&type=regional&status=inactive&sortBy=name&sortOrder=asc","method":"GET","requestId":"req-1747062175502-ha2xfzsir34","service":"branch-service","timestamp":"2025-05-12 22:02:55:255","url":"/api/v1/branches?page=1&limit=10&type=regional&status=inactive&sortBy=name&sortOrder=asc"}
{"duration":2,"ip":"::1","level":"warn","message":"GET /?page=1&limit=10&type=regional&status=inactive&sortBy=name&sortOrder=asc 401 - 2ms","method":"GET","requestId":"req-1747062175502-ha2xfzsir34","service":"branch-service","status":401,"timestamp":"2025-05-12 22:02:55:255","url":"/?page=1&limit=10&type=regional&status=inactive&sortBy=name&sortOrder=asc"}
{"level":"info","message":"Branch Management Service running on port 3003","service":"branch-service","timestamp":"2025-05-12 22:04:22:422"}
{"level":"info","message":"Redis client connected","service":"branch-service","timestamp":"2025-05-12 22:04:22:422"}
{"level":"info","message":"Connected to Redis","service":"branch-service","timestamp":"2025-05-12 22:04:22:422"}
{"level":"info","message":"Connected to MongoDB","service":"branch-service","timestamp":"2025-05-12 22:04:22:422"}
{"level":"error","message":"Error getting service area by ID: Cannot read properties of undefined (reading 'get')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'get')\n    at Object.get [as getServiceAreaById] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:169:42)\n    at Object.getServiceAreaById (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:209:35)\n    at Promise.then.completed (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\testWorker.js:106:12)","timestamp":"2025-05-12 22:31:33:3133"}
{"level":"error","message":"Error getting service area by ID: Cannot read properties of undefined (reading 'get')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'get')\n    at Object.get [as getServiceAreaById] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:169:42)\n    at Object.getServiceAreaById (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:232:35)\n    at Promise.then.completed (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\testWorker.js:106:12)","timestamp":"2025-05-12 22:31:33:3133"}
{"level":"error","message":"Error updating service area: Cannot read properties of undefined (reading 'toObject')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toObject')\n    at Object.toObject [as updateServiceArea] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:374:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:285:7)","timestamp":"2025-05-12 22:31:33:3133"}
{"level":"error","message":"Error updating service area status: Cannot read properties of undefined (reading 'toObject')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toObject')\n    at Object.toObject [as updateServiceAreaStatus] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:510:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:378:7)","timestamp":"2025-05-12 22:31:33:3133"}
{"level":"error","message":"Error updating service area pricing: Cannot read properties of undefined (reading 'toObject')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toObject')\n    at Object.toObject [as updateServiceAreaPricing] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:786:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:456:7)","timestamp":"2025-05-12 22:31:33:3133"}
{"kind":"ObjectId","level":"error","message":"Error assigning branch to service area: Cast to ObjectId failed for value \"branch123\" (type string) at path \"_id\" for model \"Branch\"","path":"_id","reason":{},"service":"branch-service","stack":"CastError: Cast to ObjectId failed for value \"branch123\" (type string) at path \"_id\" for model \"Branch\"\n    at ObjectId.Object.<anonymous>.ObjectId.cast (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\schema\\objectid.js:250:11)\n    at ObjectId.Object.<anonymous>.SchemaType.applySetters (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\schematype.js:1219:12)\n    at ObjectId.Object.<anonymous>.SchemaType.castForQuery (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\schematype.js:1633:15)\n    at cast (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\cast.js:389:32)\n    at model.Query.Object.<anonymous>.Query.cast (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:4927:12)\n    at model.Query.Object.<anonymous>.Query._castConditions (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:2237:10)\n    at model.Query._findOne (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:2533:8)\n    at model.Query.exec (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:4447:28)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.assignBranchToServiceArea (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:565:20)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:516:7)","stringValue":"\"branch123\"","timestamp":"2025-05-12 22:31:33:3133","value":"branch123","valueType":"string"}
{"level":"error","message":"Error removing branch from service area: Cannot read properties of undefined (reading 'toString')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toString')\n    at toString (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:690:23)\n    at Array.some (<anonymous>)\n    at Object.some [as removeBranchFromServiceArea] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:689:47)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:572:7)","timestamp":"2025-05-12 22:31:33:3133"}
{"level":"error","message":"Error checking point in service area: serviceAreas is not iterable","service":"branch-service","stack":"TypeError: serviceAreas is not iterable\n    at Object.serviceAreas [as checkPointInServiceArea] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:835:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:619:7)","timestamp":"2025-05-12 22:31:33:3133"}
{"level":"error","message":"Error getting service area history: ServiceAreaHistory.find(...).sort(...).skip is not a function","service":"branch-service","stack":"TypeError: ServiceAreaHistory.find(...).sort(...).skip is not a function\n    at Object.skip [as getServiceAreaHistory] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:967:8)\n    at Object.getServiceAreaHistory (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:672:35)\n    at Promise.then.completed (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\testWorker.js:106:12)","timestamp":"2025-05-12 22:31:33:3133"}
{"level":"error","message":"Error getting service area by ID: Cannot read properties of undefined (reading 'get')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'get')\n    at Object.get [as getServiceAreaById] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:169:42)\n    at Object.getServiceAreaById (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:212:35)\n    at Promise.then.completed (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\testWorker.js:106:12)","timestamp":"2025-05-12 22:35:23:3523"}
{"level":"error","message":"Error getting service area by ID: Cannot read properties of undefined (reading 'get')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'get')\n    at Object.get [as getServiceAreaById] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:169:42)\n    at Object.getServiceAreaById (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:235:35)\n    at Promise.then.completed (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\testWorker.js:106:12)","timestamp":"2025-05-12 22:35:23:3523"}
{"level":"error","message":"Error updating service area: Cannot read properties of undefined (reading 'toObject')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toObject')\n    at Object.toObject [as updateServiceArea] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:374:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:288:7)","timestamp":"2025-05-12 22:35:23:3523"}
{"level":"error","message":"Error updating service area status: Cannot read properties of undefined (reading 'toObject')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toObject')\n    at Object.toObject [as updateServiceAreaStatus] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:510:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:381:7)","timestamp":"2025-05-12 22:35:23:3523"}
{"level":"error","message":"Error updating service area pricing: Cannot read properties of undefined (reading 'toObject')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toObject')\n    at Object.toObject [as updateServiceAreaPricing] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:786:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:459:7)","timestamp":"2025-05-12 22:35:23:3523"}
{"kind":"ObjectId","level":"error","message":"Error assigning branch to service area: Cast to ObjectId failed for value \"branch123\" (type string) at path \"_id\" for model \"Branch\"","path":"_id","reason":{},"service":"branch-service","stack":"CastError: Cast to ObjectId failed for value \"branch123\" (type string) at path \"_id\" for model \"Branch\"\n    at ObjectId.Object.<anonymous>.ObjectId.cast (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\schema\\objectid.js:250:11)\n    at ObjectId.Object.<anonymous>.SchemaType.applySetters (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\schematype.js:1219:12)\n    at ObjectId.Object.<anonymous>.SchemaType.castForQuery (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\schematype.js:1633:15)\n    at cast (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\cast.js:389:32)\n    at model.Query.Object.<anonymous>.Query.cast (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:4927:12)\n    at model.Query.Object.<anonymous>.Query._castConditions (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:2237:10)\n    at model.Query._findOne (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:2533:8)\n    at model.Query.exec (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:4447:28)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.assignBranchToServiceArea (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:565:20)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:519:7)","stringValue":"\"branch123\"","timestamp":"2025-05-12 22:35:23:3523","value":"branch123","valueType":"string"}
{"level":"error","message":"Error removing branch from service area: Cannot read properties of undefined (reading 'toString')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toString')\n    at toString (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:690:23)\n    at Array.some (<anonymous>)\n    at Object.some [as removeBranchFromServiceArea] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:689:47)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:575:7)","timestamp":"2025-05-12 22:35:23:3523"}
{"level":"error","message":"Error checking point in service area: serviceAreas is not iterable","service":"branch-service","stack":"TypeError: serviceAreas is not iterable\n    at Object.serviceAreas [as checkPointInServiceArea] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:835:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:622:7)","timestamp":"2025-05-12 22:35:23:3523"}
{"level":"error","message":"Error getting service area history: ServiceAreaHistory.find(...).sort(...).skip is not a function","service":"branch-service","stack":"TypeError: ServiceAreaHistory.find(...).sort(...).skip is not a function\n    at Object.skip [as getServiceAreaHistory] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:967:8)\n    at Object.getServiceAreaHistory (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:675:35)\n    at Promise.then.completed (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\testWorker.js:106:12)","timestamp":"2025-05-12 22:35:23:3523"}
{"level":"error","message":"Error getting service area by ID: Cannot read properties of undefined (reading 'get')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'get')\n    at Object.get [as getServiceAreaById] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:169:42)\n    at Object.getServiceAreaById (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:212:35)\n    at Promise.then.completed (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\testWorker.js:106:12)","timestamp":"2025-05-12 22:36:17:3617"}
{"level":"error","message":"Error getting service area by ID: Cannot read properties of undefined (reading 'get')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'get')\n    at Object.get [as getServiceAreaById] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:169:42)\n    at Object.getServiceAreaById (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:235:35)\n    at Promise.then.completed (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\testWorker.js:106:12)","timestamp":"2025-05-12 22:36:17:3617"}
{"level":"error","message":"Error updating service area: Cannot read properties of undefined (reading 'toObject')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toObject')\n    at Object.toObject [as updateServiceArea] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:374:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:288:7)","timestamp":"2025-05-12 22:36:17:3617"}
{"level":"error","message":"Error updating service area status: Cannot read properties of undefined (reading 'toObject')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toObject')\n    at Object.toObject [as updateServiceAreaStatus] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:510:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:381:7)","timestamp":"2025-05-12 22:36:17:3617"}
{"level":"error","message":"Error updating service area pricing: Cannot read properties of undefined (reading 'toObject')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toObject')\n    at Object.toObject [as updateServiceAreaPricing] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:786:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:459:7)","timestamp":"2025-05-12 22:36:17:3617"}
{"kind":"ObjectId","level":"error","message":"Error assigning branch to service area: Cast to ObjectId failed for value \"branch123\" (type string) at path \"_id\" for model \"Branch\"","path":"_id","reason":{},"service":"branch-service","stack":"CastError: Cast to ObjectId failed for value \"branch123\" (type string) at path \"_id\" for model \"Branch\"\n    at ObjectId.Object.<anonymous>.ObjectId.cast (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\schema\\objectid.js:250:11)\n    at ObjectId.Object.<anonymous>.SchemaType.applySetters (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\schematype.js:1219:12)\n    at ObjectId.Object.<anonymous>.SchemaType.castForQuery (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\schematype.js:1633:15)\n    at cast (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\cast.js:389:32)\n    at model.Query.Object.<anonymous>.Query.cast (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:4927:12)\n    at model.Query.Object.<anonymous>.Query._castConditions (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:2237:10)\n    at model.Query._findOne (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:2533:8)\n    at model.Query.exec (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:4447:28)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.assignBranchToServiceArea (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:565:20)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:519:7)","stringValue":"\"branch123\"","timestamp":"2025-05-12 22:36:17:3617","value":"branch123","valueType":"string"}
{"level":"error","message":"Error removing branch from service area: Cannot read properties of undefined (reading 'toString')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toString')\n    at toString (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:690:23)\n    at Array.some (<anonymous>)\n    at Object.some [as removeBranchFromServiceArea] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:689:47)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:575:7)","timestamp":"2025-05-12 22:36:17:3617"}
{"level":"error","message":"Error checking point in service area: serviceAreas is not iterable","service":"branch-service","stack":"TypeError: serviceAreas is not iterable\n    at Object.serviceAreas [as checkPointInServiceArea] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:835:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:622:7)","timestamp":"2025-05-12 22:36:17:3617"}
{"level":"error","message":"Error getting service area history: ServiceAreaHistory.find(...).sort(...).skip is not a function","service":"branch-service","stack":"TypeError: ServiceAreaHistory.find(...).sort(...).skip is not a function\n    at Object.skip [as getServiceAreaHistory] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:967:8)\n    at Object.getServiceAreaHistory (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:675:35)\n    at Promise.then.completed (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\testWorker.js:106:12)","timestamp":"2025-05-12 22:36:17:3617"}
{"level":"error","message":"Error getting service area by ID: Cannot read properties of undefined (reading 'get')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'get')\n    at Object.get [as getServiceAreaById] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:169:42)\n    at Object.getServiceAreaById (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:212:35)\n    at Promise.then.completed (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\testWorker.js:106:12)","timestamp":"2025-05-12 22:36:32:3632"}
{"level":"error","message":"Error getting service area by ID: Cannot read properties of undefined (reading 'get')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'get')\n    at Object.get [as getServiceAreaById] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:169:42)\n    at Object.getServiceAreaById (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:235:35)\n    at Promise.then.completed (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\testWorker.js:106:12)","timestamp":"2025-05-12 22:36:32:3632"}
{"level":"error","message":"Error updating service area: Cannot read properties of undefined (reading 'toObject')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toObject')\n    at Object.toObject [as updateServiceArea] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:374:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:288:7)","timestamp":"2025-05-12 22:36:32:3632"}
{"level":"error","message":"Error updating service area status: Cannot read properties of undefined (reading 'toObject')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toObject')\n    at Object.toObject [as updateServiceAreaStatus] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:510:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:381:7)","timestamp":"2025-05-12 22:36:32:3632"}
{"level":"error","message":"Error updating service area pricing: Cannot read properties of undefined (reading 'toObject')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toObject')\n    at Object.toObject [as updateServiceAreaPricing] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:786:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:459:7)","timestamp":"2025-05-12 22:36:32:3632"}
{"kind":"ObjectId","level":"error","message":"Error assigning branch to service area: Cast to ObjectId failed for value \"branch123\" (type string) at path \"_id\" for model \"Branch\"","path":"_id","reason":{},"service":"branch-service","stack":"CastError: Cast to ObjectId failed for value \"branch123\" (type string) at path \"_id\" for model \"Branch\"\n    at ObjectId.Object.<anonymous>.ObjectId.cast (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\schema\\objectid.js:250:11)\n    at ObjectId.Object.<anonymous>.SchemaType.applySetters (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\schematype.js:1219:12)\n    at ObjectId.Object.<anonymous>.SchemaType.castForQuery (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\schematype.js:1633:15)\n    at cast (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\cast.js:389:32)\n    at model.Query.Object.<anonymous>.Query.cast (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:4927:12)\n    at model.Query.Object.<anonymous>.Query._castConditions (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:2237:10)\n    at model.Query._findOne (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:2533:8)\n    at model.Query.exec (D:\\PROJECT\\sarana-app\\node_modules\\mongoose\\lib\\query.js:4447:28)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.assignBranchToServiceArea (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:565:20)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:519:7)","stringValue":"\"branch123\"","timestamp":"2025-05-12 22:36:32:3632","value":"branch123","valueType":"string"}
{"level":"error","message":"Error removing branch from service area: Cannot read properties of undefined (reading 'toString')","service":"branch-service","stack":"TypeError: Cannot read properties of undefined (reading 'toString')\n    at toString (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:690:23)\n    at Array.some (<anonymous>)\n    at Object.some [as removeBranchFromServiceArea] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:689:47)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:575:7)","timestamp":"2025-05-12 22:36:32:3632"}
{"level":"error","message":"Error checking point in service area: serviceAreas is not iterable","service":"branch-service","stack":"TypeError: serviceAreas is not iterable\n    at Object.serviceAreas [as checkPointInServiceArea] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:835:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:622:7)","timestamp":"2025-05-12 22:36:32:3632"}
{"level":"error","message":"Error getting service area history: ServiceAreaHistory.find(...).sort(...).skip is not a function","service":"branch-service","stack":"TypeError: ServiceAreaHistory.find(...).sort(...).skip is not a function\n    at Object.skip [as getServiceAreaHistory] (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\controllers\\serviceAreaController.js:967:8)\n    at Object.getServiceAreaHistory (D:\\PROJECT\\sarana-app\\apps\\branch-service\\src\\__tests__\\controllers\\serviceAreaController.test.js:675:35)\n    at Promise.then.completed (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\PROJECT\\sarana-app\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\PROJECT\\sarana-app\\node_modules\\jest-runner\\build\\testWorker.js:106:12)","timestamp":"2025-05-12 22:36:32:3632"}
{"level":"info","message":"Branch Management Service running on port 3003","service":"branch-service","timestamp":"2025-05-12 22:47:42:4742"}
{"level":"info","message":"Redis client connected","service":"branch-service","timestamp":"2025-05-12 22:47:42:4742"}
{"level":"info","message":"Connected to Redis","service":"branch-service","timestamp":"2025-05-12 22:47:42:4742"}
{"level":"info","message":"Connected to MongoDB","service":"branch-service","timestamp":"2025-05-12 22:47:42:4742"}
{"ip":"::1","level":"info","message":"GET /api-docs/","method":"GET","requestId":"req-1747064897149-b6sqc7cnw6","service":"branch-service","timestamp":"2025-05-12 22:48:17:4817","url":"/api-docs/"}
{"duration":19,"ip":"::1","level":"info","message":"GET / 304 - 19ms","method":"GET","requestId":"req-1747064897149-b6sqc7cnw6","service":"branch-service","status":304,"timestamp":"2025-05-12 22:48:17:4817","url":"/"}
{"ip":"::1","level":"info","message":"GET /api-docs/swagger-ui.css","method":"GET","requestId":"req-1747064897267-46elkc6p0mo","service":"branch-service","timestamp":"2025-05-12 22:48:17:4817","url":"/api-docs/swagger-ui.css"}
{"duration":4,"ip":"::1","level":"info","message":"GET /swagger-ui.css 304 - 4ms","method":"GET","requestId":"req-1747064897267-46elkc6p0mo","service":"branch-service","status":304,"timestamp":"2025-05-12 22:48:17:4817","url":"/swagger-ui.css"}
{"ip":"::1","level":"info","message":"GET /api-docs/swagger-ui-standalone-preset.js","method":"GET","requestId":"req-1747064897273-e5cg61pjau7","service":"branch-service","timestamp":"2025-05-12 22:48:17:4817","url":"/api-docs/swagger-ui-standalone-preset.js"}
{"duration":3,"ip":"::1","level":"info","message":"GET /swagger-ui-standalone-preset.js 304 - 3ms","method":"GET","requestId":"req-1747064897273-e5cg61pjau7","service":"branch-service","status":304,"timestamp":"2025-05-12 22:48:17:4817","url":"/swagger-ui-standalone-preset.js"}
{"ip":"::1","level":"info","message":"GET /api-docs/swagger-ui-bundle.js","method":"GET","requestId":"req-1747064897277-b9oyug7y85r","service":"branch-service","timestamp":"2025-05-12 22:48:17:4817","url":"/api-docs/swagger-ui-bundle.js"}
{"ip":"::1","level":"info","message":"GET /api-docs/swagger-ui-init.js","method":"GET","requestId":"req-1747064897279-knrcayeeo0a","service":"branch-service","timestamp":"2025-05-12 22:48:17:4817","url":"/api-docs/swagger-ui-init.js"}
{"duration":10,"ip":"::1","level":"info","message":"GET /swagger-ui-bundle.js 304 - 10ms","method":"GET","requestId":"req-1747064897277-b9oyug7y85r","service":"branch-service","status":304,"timestamp":"2025-05-12 22:48:17:4817","url":"/swagger-ui-bundle.js"}
{"duration":20,"ip":"::1","level":"info","message":"GET /swagger-ui-init.js 200 - 20ms","method":"GET","requestId":"req-1747064897279-knrcayeeo0a","service":"branch-service","status":200,"timestamp":"2025-05-12 22:48:17:4817","url":"/swagger-ui-init.js"}
